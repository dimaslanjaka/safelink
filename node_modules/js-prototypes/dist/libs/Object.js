/* eslint-disable @typescript-eslint/no-unused-vars */
/* eslint-disable no-prototype-builtins */
/* eslint-disable @typescript-eslint/triple-slash-reference */
const __global = (typeof window != 'undefined' ? window : global) /* node */;
Object.size = function (obj) {
    let size = 0, key;
    for (key in obj) {
        if (obj.hasOwnProperty(key))
            size++;
    }
    return size;
};
Object.child = function (str, callback) {
    const self = this;
    if (self.hasOwnProperty(str)) {
        if (typeof callback == 'function') {
            return callback(self[str]);
        }
        else {
            return true;
        }
    }
    else {
        return undefined;
    }
};
Object.alt = function (str, alternative) {
    const self = this;
    if (self.hasOwnProperty(str)) {
        return self[str];
    }
    else {
        return alternative;
    }
};
Object.has = function (str) {
    return this.hasOwnProperty(str);
};
Object.each = function (callback) {
    for (const key in this) {
        //callback.call(scope, key, this[key]);
        callback.call(this[key]);
    }
};
Object.isEmpty = function () {
    return this.length === 0;
};
Object.replaceKeyFrom = function (anotherObj) {
    return Object.entries(this).reduce((op, [key, value]) => {
        const newKey = anotherObj[key];
        op[newKey || key] = value;
        return op;
    }, {});
    /*if (typeof anotherObj == 'object') {
      for (const key in anotherObj) {
        if (Object.prototype.hasOwnProperty.call(anotherObj, key)) {
          const element = anotherObj[key];
          def[key] = element;
        }
      }
    }*/
};
Object.prototype.merge = function (...others) {
    const hasReadOnlyProp = Object.keys(this).some((property) => {
        return isObjectWritable(this, property);
    });
    if (!hasReadOnlyProp)
        return mergeDeep(this, ...others);
    return Object.assign(Object.assign({}, this), ...others);
};
/**
 * is Object Writable?
 * @param obj
 * @param key
 * @returns
 */
function isObjectWritable(obj, key) {
    const desc = Object.getOwnPropertyDescriptor(obj, key) || {};
    return Boolean(desc.writable);
}
__global.isObjectWritable = isObjectWritable;
/**
 * Join object to separated string
 * * [].join() equivalent
 * @param obj Object
 * @param separator default comma(,)
 * @returns Joined string
 */
function object_join(obj, separator = ',') {
    return Object.keys(obj)
        .map(function (k) {
        return obj[k];
    })
        .join(separator);
}
__global.object_join = object_join;
/**
 * Simple object check.
 * @param item
 * @returns
 * @example
 * ```js
 * console.log(isObject({a:'a'})); // true
 * console.log(isObject(['a','b'])); // false
 * ```
 */
function isObject(item) {
    return item && typeof item === 'object' && !Array.isArray(item);
}
__global.isObject = isObject;
/**
 * Deep merge two objects.
 * @param target
 * @param ...sources
 * @see {@link https://bit.ly/3v1vlXu}
 */
function mergeDeep(target, ...sources) {
    if (!sources.length)
        return target;
    const source = sources.shift();
    if (isObject(target) && isObject(source)) {
        for (const key in source) {
            if (isObject(source[key])) {
                if (!target[key])
                    Object.assign(target, { [key]: {} });
                mergeDeep(target[key], source[key]);
            }
            else {
                // @fixme writable property
                Object.assign(target, { [key]: source[key] });
                // @fixme readonly property
                //target = { ...target, [key]: source[key] };
            }
        }
    }
    return mergeDeep(target, ...sources);
}
__global.mergeDeep = mergeDeep;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiT2JqZWN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL09iamVjdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxzREFBc0Q7QUFDdEQsMENBQTBDO0FBQzFDLDhEQUE4RDtBQUM5RCxNQUFNLFFBQVEsR0FBRyxDQUFDLE9BQU8sTUFBTSxJQUFJLFdBQVcsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxVQUFpQixDQUFDO0FBNEVwRixNQUFNLENBQUMsSUFBSSxHQUFHLFVBQVUsR0FBRztJQUN6QixJQUFJLElBQUksR0FBRyxDQUFDLEVBQ1YsR0FBUSxDQUFDO0lBQ1gsS0FBSyxHQUFHLElBQUksR0FBRyxFQUFFO1FBQ2YsSUFBSSxHQUFHLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQztZQUFFLElBQUksRUFBRSxDQUFDO0tBQ3JDO0lBQ0QsT0FBTyxJQUFJLENBQUM7QUFDZCxDQUFDLENBQUM7QUFFRixNQUFNLENBQUMsS0FBSyxHQUFHLFVBQVUsR0FBRyxFQUFFLFFBQVE7SUFDcEMsTUFBTSxJQUFJLEdBQVcsSUFBSSxDQUFDO0lBQzFCLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsRUFBRTtRQUM1QixJQUFJLE9BQU8sUUFBUSxJQUFJLFVBQVUsRUFBRTtZQUNqQyxPQUFPLFFBQVEsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztTQUM1QjthQUFNO1lBQ0wsT0FBTyxJQUFJLENBQUM7U0FDYjtLQUNGO1NBQU07UUFDTCxPQUFPLFNBQVMsQ0FBQztLQUNsQjtBQUNILENBQUMsQ0FBQztBQUVGLE1BQU0sQ0FBQyxHQUFHLEdBQUcsVUFBVSxHQUFHLEVBQUUsV0FBVztJQUNyQyxNQUFNLElBQUksR0FBUSxJQUFJLENBQUM7SUFDdkIsSUFBSSxJQUFJLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxFQUFFO1FBQzVCLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0tBQ2xCO1NBQU07UUFDTCxPQUFPLFdBQVcsQ0FBQztLQUNwQjtBQUNILENBQUMsQ0FBQztBQUVGLE1BQU0sQ0FBQyxHQUFHLEdBQUcsVUFBVSxHQUFvQjtJQUN6QyxPQUFPLElBQUksQ0FBQyxjQUFjLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDbEMsQ0FBQyxDQUFDO0FBRUYsTUFBTSxDQUFDLElBQUksR0FBRyxVQUFVLFFBQVE7SUFDOUIsS0FBSyxNQUFNLEdBQUcsSUFBSSxJQUFJLEVBQUU7UUFDdEIsdUNBQXVDO1FBQ3ZDLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7S0FDMUI7QUFDSCxDQUFDLENBQUM7QUFFRixNQUFNLENBQUMsT0FBTyxHQUFHO0lBQ2YsT0FBTyxJQUFJLENBQUMsTUFBTSxLQUFLLENBQUMsQ0FBQztBQUMzQixDQUFDLENBQUM7QUFFRixNQUFNLENBQUMsY0FBYyxHQUFHLFVBQVUsVUFBVTtJQUMxQyxPQUFPLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxFQUFFLEVBQUU7UUFDdEQsTUFBTSxNQUFNLEdBQUcsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQy9CLEVBQUUsQ0FBQyxNQUFNLElBQUksR0FBRyxDQUFDLEdBQUcsS0FBSyxDQUFDO1FBQzFCLE9BQU8sRUFBRSxDQUFDO0lBQ1osQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQ1A7Ozs7Ozs7T0FPRztBQUNMLENBQUMsQ0FBQztBQUVGLE1BQU0sQ0FBQyxTQUFTLENBQUMsS0FBSyxHQUFHLFVBQXNDLEdBQUcsTUFBTTtJQUN0RSxNQUFNLGVBQWUsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsRUFBRSxFQUFFO1FBQzFELE9BQU8sZ0JBQWdCLENBQUMsSUFBSSxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQzFDLENBQUMsQ0FBQyxDQUFDO0lBQ0gsSUFBSSxDQUFDLGVBQWU7UUFBRSxPQUFPLFNBQVMsQ0FBQyxJQUFJLEVBQUUsR0FBRyxNQUFNLENBQUMsQ0FBQztJQUN4RCxPQUFPLE1BQU0sQ0FBQyxNQUFNLG1CQUFNLElBQUksR0FBSSxHQUFHLE1BQU0sQ0FBQyxDQUFDO0FBQy9DLENBQUMsQ0FBQztBQUVGOzs7OztHQUtHO0FBQ0gsU0FBUyxnQkFBZ0IsQ0FBaUMsR0FBTSxFQUFFLEdBQVk7SUFDNUUsTUFBTSxJQUFJLEdBQUcsTUFBTSxDQUFDLHdCQUF3QixDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDN0QsT0FBTyxPQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ2hDLENBQUM7QUFDRCxRQUFRLENBQUMsZ0JBQWdCLEdBQUcsZ0JBQWdCLENBQUM7QUFFN0M7Ozs7OztHQU1HO0FBQ0gsU0FBUyxXQUFXLENBQUMsR0FBeUIsRUFBRSxTQUFTLEdBQUcsR0FBRztJQUM3RCxPQUFPLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDO1NBQ3BCLEdBQUcsQ0FBQyxVQUFVLENBQUM7UUFDZCxPQUFPLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNoQixDQUFDLENBQUM7U0FDRCxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDckIsQ0FBQztBQUNELFFBQVEsQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDO0FBRW5DOzs7Ozs7Ozs7R0FTRztBQUNILFNBQVMsUUFBUSxDQUFDLElBQVM7SUFDekIsT0FBTyxJQUFJLElBQUksT0FBTyxJQUFJLEtBQUssUUFBUSxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNsRSxDQUFDO0FBQ0QsUUFBUSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7QUFFN0I7Ozs7O0dBS0c7QUFDSCxTQUFTLFNBQVMsQ0FBQyxNQUF3QixFQUFFLEdBQUcsT0FBMkI7SUFDekUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNO1FBQUUsT0FBTyxNQUFNLENBQUM7SUFDbkMsTUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFDO0lBRS9CLElBQUksUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJLFFBQVEsQ0FBQyxNQUFNLENBQUMsRUFBRTtRQUN4QyxLQUFLLE1BQU0sR0FBRyxJQUFJLE1BQU0sRUFBRTtZQUN4QixJQUFJLFFBQVEsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRTtnQkFDekIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUM7b0JBQUUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUM7Z0JBQ3ZELFNBQVMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEVBQU8sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7YUFDMUM7aUJBQU07Z0JBQ0wsMkJBQTJCO2dCQUMzQixNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsTUFBTSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQztnQkFDOUMsMkJBQTJCO2dCQUMzQiw2Q0FBNkM7YUFDOUM7U0FDRjtLQUNGO0lBRUQsT0FBTyxTQUFTLENBQUMsTUFBTSxFQUFFLEdBQUcsT0FBTyxDQUFDLENBQUM7QUFDdkMsQ0FBQztBQUNELFFBQVEsQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzICovXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1wcm90b3R5cGUtYnVpbHRpbnMgKi9cbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC90cmlwbGUtc2xhc2gtcmVmZXJlbmNlICovXG5jb25zdCBfX2dsb2JhbCA9ICh0eXBlb2Ygd2luZG93ICE9ICd1bmRlZmluZWQnID8gd2luZG93IDogZ2xvYmFsKSAvKiBub2RlICovIGFzIGFueTtcblxuaW50ZXJmYWNlIE9iamVjdCB7XG4gIGxlbmd0aDogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBEeW5hbWljIEtleVxuICAgKi9cbiAgW3N0cjogc3RyaW5nXTogYW55O1xuXG4gIC8qKlxuICAgKiBNZXJnZSB0aGlzIG9iamVjdCB3aXRoIGFub3RoZXIgb2JqZWN0XG4gICAqL1xuICBtZXJnZTogKC4uLm90aGVyOiBSZWNvcmQ8YW55LCB1bmtub3duPltdKSA9PiBSZWNvcmQ8YW55LCB1bmtub3duPjtcblxuICAvKipcbiAgICogSXRlcmF0ZSBPYmplY3RcbiAgICogQHBhcmFtIGNhbGxiYWNrIGZ1bmN0aW9uIGVhY2ggZWxlbWVudFxuICAgKiBAZXhhbXBsZVxuICAgKiB2YXIgYSA9IHsnYScsJ24nfTtcbiAgICogYS5lYWNoKGZ1bmN0aW9uKGVsKXtcbiAgICogIGNvbnNvbGUubG9nKGVsKTsgLy9hLCBuIGVhY2ggaXRlcmF0aW9uXG4gICAqIH0pXG4gICAqL1xuICBlYWNoKGNhbGxiYWNrOiAoYXJnMDogYW55KSA9PiBhbnkpOiBhbnk7XG5cbiAgLyoqXG4gICAqIENoZWNrIGlzIGVtcHR5XG4gICAqL1xuICBpc0VtcHR5KCk6IGJvb2xlYW47XG5cbiAgcmVwbGFjZUtleUZyb20oYW5vdGhlck9iajogYW55KTogYW55O1xufVxuXG5pbnRlcmZhY2UgT2JqZWN0Q29uc3RydWN0b3Ige1xuICAvKipcbiAgICogRHluYW1pYyBLZXlcbiAgICovXG4gIFtzdHI6IHN0cmluZ106IGFueTtcblxuICAvKipcbiAgICogQ291bnQgc2l6ZSBsZW5ndGggb2Ygb2JqZWN0XG4gICAqL1xuICBzaXplOiAob2JqOiBhbnkpID0+IG51bWJlcjtcblxuICAvL1twYWlyOiBzdHJpbmd8bnVtYmVyXTogYW55O1xuXG4gIC8qKlxuICAgKiBJcyBPYmplY3QgSGFzIFByb3BlcnR5IG9mIGtleSA/XG4gICAqIEBwYXJhbSBrZXlcbiAgICovXG4gIGhhc093blByb3BlcnR5KGtleTogYW55KTogYm9vbGVhbjtcblxuICAvKipcbiAgICogY2hlY2sgaWYgaGFzIGNoaWxkIGFuZCBnbyBmb3IgY2FsbGJhY2tcbiAgICogQHBhcmFtIHN0ciAgbWF0Y2ggY2hpbGQgcHJvcGVydHlcbiAgICogQHBhcmFtIGNhbGxiYWNrIGZ1bmN0aW9uIGNhbGxiYWNrXG4gICAqIEBhdXRob3IgRGltYXMgTGFuamFrYSA8ZGltYXNsYW5qYWthQGdtYWlsLmNvbT5cbiAgICovXG4gIGNoaWxkKHN0cjogc3RyaW5nIHwgbnVtYmVyLCBjYWxsYmFjazogKGFyZzogYW55KSA9PiBhbnkpOiBhbnk7XG5cbiAgLyoqXG4gICAqIGNoZWNrIG9iamVjdCBoYXMgY2hpbGQsIGlmIG5vdCBleGlzdCByZXR1cm4gYWx0ZXJuYXRpdmUgdmFsdWVcbiAgICogQHBhcmFtIHN0ciBtYXRjaCBjaGlsZCBwcm9wZXJ0eVxuICAgKiBAcGFyYW0gYWx0ZXJuYXRpdmUgZGVmYXVsdCB2YWx1ZSBjYWxsYmFja1xuICAgKiBAYXV0aG9yIERpbWFzIExhbmpha2EgPGRpbWFzbGFuamFrYUBnbWFpbC5jb20+XG4gICAqL1xuICBhbHQoc3RyOiBhbnksIGFsdGVybmF0aXZlOiBzdHJpbmcgfCBudW1iZXIgfCBib29sZWFuKTogYW55O1xuXG4gIC8qKlxuICAgKiBDaGVjayBvYmplY3QgaGFzIGNoaWxkXG4gICAqIEBwYXJhbSBzdHJcbiAgICovXG4gIGhhcyhzdHI6IHN0cmluZyB8IG51bWJlcik6IGFueTtcbn1cblxuT2JqZWN0LnNpemUgPSBmdW5jdGlvbiAob2JqKSB7XG4gIGxldCBzaXplID0gMCxcbiAgICBrZXk6IGFueTtcbiAgZm9yIChrZXkgaW4gb2JqKSB7XG4gICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSBzaXplKys7XG4gIH1cbiAgcmV0dXJuIHNpemU7XG59O1xuXG5PYmplY3QuY2hpbGQgPSBmdW5jdGlvbiAoc3RyLCBjYWxsYmFjaykge1xuICBjb25zdCBzZWxmOiBvYmplY3QgPSB0aGlzO1xuICBpZiAoc2VsZi5oYXNPd25Qcm9wZXJ0eShzdHIpKSB7XG4gICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PSAnZnVuY3Rpb24nKSB7XG4gICAgICByZXR1cm4gY2FsbGJhY2soc2VsZltzdHJdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbn07XG5cbk9iamVjdC5hbHQgPSBmdW5jdGlvbiAoc3RyLCBhbHRlcm5hdGl2ZSkge1xuICBjb25zdCBzZWxmOiBhbnkgPSB0aGlzO1xuICBpZiAoc2VsZi5oYXNPd25Qcm9wZXJ0eShzdHIpKSB7XG4gICAgcmV0dXJuIHNlbGZbc3RyXTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYWx0ZXJuYXRpdmU7XG4gIH1cbn07XG5cbk9iamVjdC5oYXMgPSBmdW5jdGlvbiAoc3RyOiBzdHJpbmcgfCBudW1iZXIpIHtcbiAgcmV0dXJuIHRoaXMuaGFzT3duUHJvcGVydHkoc3RyKTtcbn07XG5cbk9iamVjdC5lYWNoID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gIGZvciAoY29uc3Qga2V5IGluIHRoaXMpIHtcbiAgICAvL2NhbGxiYWNrLmNhbGwoc2NvcGUsIGtleSwgdGhpc1trZXldKTtcbiAgICBjYWxsYmFjay5jYWxsKHRoaXNba2V5XSk7XG4gIH1cbn07XG5cbk9iamVjdC5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5sZW5ndGggPT09IDA7XG59O1xuXG5PYmplY3QucmVwbGFjZUtleUZyb20gPSBmdW5jdGlvbiAoYW5vdGhlck9iaikge1xuICByZXR1cm4gT2JqZWN0LmVudHJpZXModGhpcykucmVkdWNlKChvcCwgW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgY29uc3QgbmV3S2V5ID0gYW5vdGhlck9ialtrZXldO1xuICAgIG9wW25ld0tleSB8fCBrZXldID0gdmFsdWU7XG4gICAgcmV0dXJuIG9wO1xuICB9LCB7fSk7XG4gIC8qaWYgKHR5cGVvZiBhbm90aGVyT2JqID09ICdvYmplY3QnKSB7XG4gICAgZm9yIChjb25zdCBrZXkgaW4gYW5vdGhlck9iaikge1xuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChhbm90aGVyT2JqLCBrZXkpKSB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSBhbm90aGVyT2JqW2tleV07XG4gICAgICAgIGRlZltrZXldID0gZWxlbWVudDtcbiAgICAgIH1cbiAgICB9XG4gIH0qL1xufTtcblxuT2JqZWN0LnByb3RvdHlwZS5tZXJnZSA9IGZ1bmN0aW9uICh0aGlzOiBSZWNvcmQ8YW55LCB1bmtub3duPiwgLi4ub3RoZXJzKSB7XG4gIGNvbnN0IGhhc1JlYWRPbmx5UHJvcCA9IE9iamVjdC5rZXlzKHRoaXMpLnNvbWUoKHByb3BlcnR5KSA9PiB7XG4gICAgcmV0dXJuIGlzT2JqZWN0V3JpdGFibGUodGhpcywgcHJvcGVydHkpO1xuICB9KTtcbiAgaWYgKCFoYXNSZWFkT25seVByb3ApIHJldHVybiBtZXJnZURlZXAodGhpcywgLi4ub3RoZXJzKTtcbiAgcmV0dXJuIE9iamVjdC5hc3NpZ24oeyAuLi50aGlzIH0sIC4uLm90aGVycyk7XG59O1xuXG4vKipcbiAqIGlzIE9iamVjdCBXcml0YWJsZT9cbiAqIEBwYXJhbSBvYmpcbiAqIEBwYXJhbSBrZXlcbiAqIEByZXR1cm5zXG4gKi9cbmZ1bmN0aW9uIGlzT2JqZWN0V3JpdGFibGU8VCBleHRlbmRzIFJlY29yZDxhbnksIHVua25vd24+PihvYmo6IFQsIGtleToga2V5b2YgVCkge1xuICBjb25zdCBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgfHwge307XG4gIHJldHVybiBCb29sZWFuKGRlc2Mud3JpdGFibGUpO1xufVxuX19nbG9iYWwuaXNPYmplY3RXcml0YWJsZSA9IGlzT2JqZWN0V3JpdGFibGU7XG5cbi8qKlxuICogSm9pbiBvYmplY3QgdG8gc2VwYXJhdGVkIHN0cmluZ1xuICogKiBbXS5qb2luKCkgZXF1aXZhbGVudFxuICogQHBhcmFtIG9iaiBPYmplY3RcbiAqIEBwYXJhbSBzZXBhcmF0b3IgZGVmYXVsdCBjb21tYSgsKVxuICogQHJldHVybnMgSm9pbmVkIHN0cmluZ1xuICovXG5mdW5jdGlvbiBvYmplY3Rfam9pbihvYmo6IFJlY29yZDxhbnksIHVua25vd24+LCBzZXBhcmF0b3IgPSAnLCcpIHtcbiAgcmV0dXJuIE9iamVjdC5rZXlzKG9iailcbiAgICAubWFwKGZ1bmN0aW9uIChrKSB7XG4gICAgICByZXR1cm4gb2JqW2tdO1xuICAgIH0pXG4gICAgLmpvaW4oc2VwYXJhdG9yKTtcbn1cbl9fZ2xvYmFsLm9iamVjdF9qb2luID0gb2JqZWN0X2pvaW47XG5cbi8qKlxuICogU2ltcGxlIG9iamVjdCBjaGVjay5cbiAqIEBwYXJhbSBpdGVtXG4gKiBAcmV0dXJuc1xuICogQGV4YW1wbGVcbiAqIGBgYGpzXG4gKiBjb25zb2xlLmxvZyhpc09iamVjdCh7YTonYSd9KSk7IC8vIHRydWVcbiAqIGNvbnNvbGUubG9nKGlzT2JqZWN0KFsnYScsJ2InXSkpOyAvLyBmYWxzZVxuICogYGBgXG4gKi9cbmZ1bmN0aW9uIGlzT2JqZWN0KGl0ZW06IGFueSk6IGJvb2xlYW4ge1xuICByZXR1cm4gaXRlbSAmJiB0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgJiYgIUFycmF5LmlzQXJyYXkoaXRlbSk7XG59XG5fX2dsb2JhbC5pc09iamVjdCA9IGlzT2JqZWN0O1xuXG4vKipcbiAqIERlZXAgbWVyZ2UgdHdvIG9iamVjdHMuXG4gKiBAcGFyYW0gdGFyZ2V0XG4gKiBAcGFyYW0gLi4uc291cmNlc1xuICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9iaXQubHkvM3YxdmxYdX1cbiAqL1xuZnVuY3Rpb24gbWVyZ2VEZWVwKHRhcmdldDogUmVjb3JkPGFueSwgYW55PiwgLi4uc291cmNlczogUmVjb3JkPGFueSwgYW55PltdKSB7XG4gIGlmICghc291cmNlcy5sZW5ndGgpIHJldHVybiB0YXJnZXQ7XG4gIGNvbnN0IHNvdXJjZSA9IHNvdXJjZXMuc2hpZnQoKTtcblxuICBpZiAoaXNPYmplY3QodGFyZ2V0KSAmJiBpc09iamVjdChzb3VyY2UpKSB7XG4gICAgZm9yIChjb25zdCBrZXkgaW4gc291cmNlKSB7XG4gICAgICBpZiAoaXNPYmplY3Qoc291cmNlW2tleV0pKSB7XG4gICAgICAgIGlmICghdGFyZ2V0W2tleV0pIE9iamVjdC5hc3NpZ24odGFyZ2V0LCB7IFtrZXldOiB7fSB9KTtcbiAgICAgICAgbWVyZ2VEZWVwKHRhcmdldFtrZXldLCA8YW55PnNvdXJjZVtrZXldKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEBmaXhtZSB3cml0YWJsZSBwcm9wZXJ0eVxuICAgICAgICBPYmplY3QuYXNzaWduKHRhcmdldCwgeyBba2V5XTogc291cmNlW2tleV0gfSk7XG4gICAgICAgIC8vIEBmaXhtZSByZWFkb25seSBwcm9wZXJ0eVxuICAgICAgICAvL3RhcmdldCA9IHsgLi4udGFyZ2V0LCBba2V5XTogc291cmNlW2tleV0gfTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gbWVyZ2VEZWVwKHRhcmdldCwgLi4uc291cmNlcyk7XG59XG5fX2dsb2JhbC5tZXJnZURlZXAgPSBtZXJnZURlZXA7XG4iXX0=