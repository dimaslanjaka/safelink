/* eslint-disable @typescript-eslint/no-unused-vars */
/* eslint-disable @typescript-eslint/no-var-requires */
/* eslint-disable prefer-rest-params */
/* eslint-disable @typescript-eslint/triple-slash-reference */
/// <reference path="globals.d.ts" />
String.prototype.printf = function (obj) {
    /*const isNode = new Function(
      "try {return this===global;}catch(e){return false;}"
    );
  
    if (isNode()) {
      const util = require("util");
      return util.format(this, obj);
    }*/
    let useArguments = false;
    const _arguments = arguments;
    let i = -1;
    if (typeof _arguments[0] == 'string') {
        useArguments = true;
    }
    if (obj instanceof Array || useArguments) {
        return this.replace(/%s/g, function (a, b) {
            i++;
            if (useArguments) {
                if (typeof _arguments[i] == 'string') {
                    return _arguments[i];
                }
                else {
                    throw new Error('Arguments element is an invalid type');
                }
            }
            return obj[i];
        });
    }
    else {
        return this.replace(/{([^{}]*)}/g, function (a, b) {
            const r = obj[b];
            return typeof r === 'string' || typeof r === 'number' ? r : a;
        });
    }
};
String.prototype.parse_url = function () {
    let parser;
    if (typeof module != 'undefined' && module.exports) {
        parser = new URL(this);
    }
    else if (typeof document != 'undefined') {
        parser = document.createElement('a');
    }
    const searchObject = [];
    let split = [];
    let queries = [];
    // Let the browser do the work
    parser.href = this.toString();
    // Convert query string to object
    queries = parser.search.replace(/^\?/, '').split('&');
    for (let i = 0; i < queries.length; i++) {
        split = queries[i].split('=');
        if (split.length)
            searchObject[split[0]] = split[1];
    }
    return {
        protocol: parser.protocol,
        host: parser.host,
        hostname: parser.hostname,
        port: parser.port,
        pathname: parser.pathname,
        search: parser.search,
        searchObject: searchObject,
        hash: parser.hash,
        protohost: parser.protocol + '//' + parser.host,
    };
};
/**
 * Load css
 */
String.prototype.CSS = function () {
    const e = document.createElement('link');
    e.rel = 'stylesheet';
    e.href = this.toString();
    const n = document.getElementsByTagName('head')[0];
    window.addEventListener
        ? window.addEventListener('load', function () {
            n.parentNode.insertBefore(e, n);
        }, !1)
        : window.attachEvent
            ? window.attachEvent('onload', function () {
                n.parentNode.insertBefore(e, n);
            })
            : (window.onload = function () {
                n.parentNode.insertBefore(e, n);
            });
};
String.prototype.trim = function () {
    return this.replace(/^\s+|\s+$/gm, '');
};
String.prototype.hexE = function () {
    let hex, i;
    let result = '';
    for (i = 0; i < this.length; i++) {
        hex = this.charCodeAt(i).toString(16);
        result += ('000' + hex).slice(-4);
    }
    return result;
};
String.prototype.hexD = function () {
    let j;
    const hexes = this.match(/.{1,4}/g) || [];
    let back = '';
    for (j = 0; j < hexes.length; j++) {
        back += String.fromCharCode(parseInt(hexes[j], 16));
    }
    return back;
};
String.prototype.capitalize = function () {
    return this.charAt(0).toUpperCase() + this.slice(1);
};
String.prototype.rot13 = function () {
    return this.replace(/[a-zA-Z]/g, function (c) {
        return String.fromCharCode((c <= 'Z' ? 90 : 122) >= (c = c.charCodeAt(0) + 13) ? c : c - 26);
    });
};
String.prototype.truncate = function (n, useWordBoundary) {
    if (this.length <= n) {
        return this;
    }
    const subString = this.substr(0, n - 1); // the original check
    return (useWordBoundary ? subString.substr(0, subString.lastIndexOf(' ')) : subString) + '&hellip;';
};
String.prototype.isEmpty = function () {
    if (this != null || typeof this != 'undefined') {
        return this.length === 0 || !this.trim();
    }
    return false;
};
String.prototype.replaceArr = function (array, replacement) {
    // eslint-disable-next-line @typescript-eslint/no-this-alias
    let ori = this;
    array.map((str) => {
        ori = ori.replace(str, replacement);
    });
    return ori;
};
String.prototype.toHtmlEntities = function () {
    return this.replace(/./gm, function (s) {
        // return "&#" + s.charCodeAt(0) + ";";
        return s.match(/[a-z0-9\s]+/i) ? s : '&#' + s.charCodeAt(0) + ';';
    });
};
String.fromHtmlEntities = function (str) {
    return (str + '').replace(/&#\d+;/gm, function (s) {
        const m = s.match(/\d+/gm)[0];
        return String.fromCharCode(m);
    });
};
String.prototype.includesArray = function (substrings) {
    return substrings.some((v) => this.includes(v));
};
const ___global = (typeof window != 'undefined' ? window : global) /* node */;
/**
 * easy regex match
 * @param str
 * @param pattern
 * @returns
 */
function strMatch(str, pattern) {
    let regex;
    if (typeof pattern == 'string') {
        regex = new RegExp(pattern, 'gm');
    }
    else {
        regex = pattern;
    }
    const match = str.match(regex) || false;
    if (Array.isArray(match)) {
        if (match.length > 0)
            return true;
    }
    return false;
}
___global.strMatch = strMatch;
String.prototype.isMatch = function (pattern) {
    return strMatch(this, pattern);
};
if (typeof ''.replaceAll != 'function') {
    String.prototype.replaceAll = function (search, replacement) {
        const find = typeof search == 'string' ? new RegExp(search, 'gm') : search;
        return this.replace(find, replacement);
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3RyaW5nLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL1N0cmluZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxzREFBc0Q7QUFDdEQsdURBQXVEO0FBQ3ZELHVDQUF1QztBQUN2Qyw4REFBOEQ7QUFDOUQscUNBQXFDO0FBbUtyQyxNQUFNLENBQUMsU0FBUyxDQUFDLE1BQU0sR0FBRyxVQUFVLEdBQUc7SUFDckM7Ozs7Ozs7T0FPRztJQUVILElBQUksWUFBWSxHQUFHLEtBQUssQ0FBQztJQUN6QixNQUFNLFVBQVUsR0FBRyxTQUFTLENBQUM7SUFDN0IsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDWCxJQUFJLE9BQU8sVUFBVSxDQUFDLENBQUMsQ0FBQyxJQUFJLFFBQVEsRUFBRTtRQUNwQyxZQUFZLEdBQUcsSUFBSSxDQUFDO0tBQ3JCO0lBQ0QsSUFBSSxHQUFHLFlBQVksS0FBSyxJQUFJLFlBQVksRUFBRTtRQUN4QyxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLFVBQVUsQ0FBQyxFQUFFLENBQUM7WUFDdkMsQ0FBQyxFQUFFLENBQUM7WUFDSixJQUFJLFlBQVksRUFBRTtnQkFDaEIsSUFBSSxPQUFPLFVBQVUsQ0FBQyxDQUFDLENBQUMsSUFBSSxRQUFRLEVBQUU7b0JBQ3BDLE9BQU8sVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDO2lCQUN0QjtxQkFBTTtvQkFDTCxNQUFNLElBQUksS0FBSyxDQUFDLHNDQUFzQyxDQUFDLENBQUM7aUJBQ3pEO2FBQ0Y7WUFDRCxPQUFPLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNoQixDQUFDLENBQUMsQ0FBQztLQUNKO1NBQU07UUFDTCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUFFLFVBQVUsQ0FBQyxFQUFFLENBQUM7WUFDL0MsTUFBTSxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2pCLE9BQU8sT0FBTyxD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LENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ2pDLENBQUMsQ0FBQztBQUVGLElBQUksT0FBTyxFQUFFLENBQUMsVUFBVSxJQUFJLFVBQVUsRUFBRTtJQUN0QyxNQUFNLENBQUMsU0FBUyxDQUFDLFVBQVUsR0FBRyxVQUFVLE1BQU0sRUFBRSxXQUFXO1FBQ3pELE1BQU0sSUFBSSxHQUFHLE9BQU8sTUFBTSxJQUFJLFFBQVEsQ0FBQyxDQUFDLENBQUMsSUFBSSxNQUFNLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUM7UUFDM0UsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxXQUFXLENBQUMsQ0FBQztJQUN6QyxDQUFDLENBQUM7Q0FDSCIsInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFycyAqL1xuLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXZhci1yZXF1aXJlcyAqL1xuLyogZXNsaW50LWRpc2FibGUgcHJlZmVyLXJlc3QtcGFyYW1zICovXG4vKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvdHJpcGxlLXNsYXNoLXJlZmVyZW5jZSAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cImdsb2JhbHMuZC50c1wiIC8+XG5cbi8qKlxuICogU3RyaW5nc1xuICovXG5pbnRlcmZhY2UgU3RyaW5nIHtcbiAgLyoqXG4gICAqIFRydW5jYXRlIHN0cmluZ1xuICAgKiBAcGFyYW0gbiBzZXF1ZW5jZSBudW1iZXIgdG8gY3V0IHRoZSBuZXh0IHNlbnRlbmNlXG4gICAqIEBwYXJhbSB1c2VXb3JkQm91bmRhcnkgdHJ1ZSA/IHN1YlN0cmluZy5zdWJzdHIoMCwgc3ViU3RyaW5nLmxhc3RJbmRleE9mKFwiIFwiKSlcbiAgICogQHNlZSBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMTk5MzUyL3NtYXJ0LXdheS10by10cnVuY2F0ZS1sb25nLXN0cmluZ3NcbiAgICovXG4gIHRydW5jYXRlOiAobjogbnVtYmVyLCB1c2VXb3JkQm91bmRhcnk6IGJvb2xlYW4gfCBudWxsKSA9PiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIEVhc3kgU3RyaW5nIE1hdGNoIEJvb2xlYW5cbiAgICogQGRlc2NyaXB0aW9uIFN0cmluZyBtYXRjaCByZXN1bHQgYXMgYm9vbGVhblxuICAgKiBAcGFyYW0gcGF0dGVybiByZWdleCBvciBzdHJpbmdcbiAgICogQHJldHVybnMgdHJ1ZSBvciBmYWxzZVxuICAgKi9cbiAgaXNNYXRjaDogKHBhdHRlcm46IFJlZ0V4cCB8IHN0cmluZykgPT4gYm9vbGVhbjtcblxuICAvKipcbiAgICogUmVwbGFjZSBhbGwgb2NjdXJyZW5jZXMgb2YgYSBzdHJpbmdcbiAgICogKiBTaGltIEVTMjAyMSBwcm90b3R5cGVcbiAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvU3RyaW5nL3JlcGxhY2VBbGx9XG4gICAqL1xuICByZXBsYWNlQWxsOiAoc2VhcmNoOiBzdHJpbmcgfCBSZWdFeHAsIHJlcGxhY2VtZW50OiBzdHJpbmcpID0+IHN0cmluZztcblxuICAvKipcbiAgICogUHJpbnRmXG4gICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS80NjA3ODM3NX1cbiAgICogQGV4YW1wbGVcbiAgICogY29uc29sZS5sb2coXCJIZWxsbyBJIGFtIFwiICsgXCIlcyAlc1wiLnByaW50ZihbXCJmb29cIiwgXCJiYXJcIl0pKTtcbiAgICovXG4gIHByaW50ZjogKG9iajogYW55W10gfCBzdHJpbmcpID0+IHN0cmluZztcblxuICAvKipcbiAgICogTWF0Y2hlcyBhIHN0cmluZyBhbiBvYmplY3QgdGhhdCBzdXBwb3J0cyBiZWluZyBtYXRjaGVkIGFnYWluc3QsIGFuZCByZXR1cm5zIGFuIGFycmF5IGNvbnRhaW5pbmcgdGhlIHJlc3VsdHMgb2ZcbiAgICogdGhhdCBzZWFyY2guXG4gICAqIEBwYXJhbSBtYXRjaGVyIEFuIG9iamVjdCB0aGF0IHN1cHBvcnRzIGJlaW5nIG1hdGNoZWQgYWdhaW5zdC5cbiAgICovXG4gIG1hdGNoKG1hdGNoZXI6IHsgW1N5bWJvbC5tYXRjaF0oc3RyaW5nOiBzdHJpbmcpOiBSZWdFeHBNYXRjaEFycmF5IHwgbnVsbCB9KTogUmVnRXhwTWF0Y2hBcnJheSB8IG51bGw7XG5cbiAgLyoqXG4gICAqIFJlcGxhY2VzIHRleHQgaW4gYSBzdHJpbmcsIHVzaW5nIGFuIG9iamVjdCB0aGF0IHN1cHBvcnRzIHJlcGxhY2VtZW50IHdpdGhpbiBhIHN0cmluZy5cbiAgICogQHBhcmFtIHNlYXJjaFZhbHVlIEEgb2JqZWN0IGNhbiBzZWFyY2ggZm9yIGFuZCByZXBsYWNlIG1hdGNoZXMgd2l0aGluIGEgc3RyaW5nLlxuICAgKiBAcGFyYW0gcmVwbGFjZVZhbHVlIEEgc3RyaW5nIGNvbnRhaW5pbmcgdGhlIHRleHQgdG8gcmVwbGFjZSBmb3IgZXZlcnkgc3VjY2Vzc2Z1bCBtYXRjaCBvZiBzZWFyY2hWYWx1ZSBpbiB0aGlzXG4gICAqICAgICBzdHJpbmcuXG4gICAqL1xuICByZXBsYWNlKFxuICAgIHNlYXJjaFZhbHVlOiB7XG4gICAgICBbU3ltYm9sLnJlcGxhY2VdKHN0cmluZzogc3RyaW5nLCByZXBsYWNlVmFsdWU6IHN0cmluZyk6IHN0cmluZztcbiAgICB9LFxuICAgIHJlcGxhY2VWYWx1ZTogc3RyaW5nXG4gICk6IHN0cmluZztcblxuICAvKipcbiAgICogUmVwbGFjZXMgdGV4dCBpbiBhIHN0cmluZywgdXNpbmcgYW4gb2JqZWN0IHRoYXQgc3VwcG9ydHMgcmVwbGFjZW1lbnQgd2l0aGluIGEgc3RyaW5nLlxuICAgKiBAcGFyYW0gc2VhcmNoVmFsdWUgQSBvYmplY3QgY2FuIHNlYXJjaCBmb3IgYW5kIHJlcGxhY2UgbWF0Y2hlcyB3aXRoaW4gYSBzdHJpbmcuXG4gICAqIEBwYXJhbSByZXBsYWNlciBBIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgcmVwbGFjZW1lbnQgdGV4dC5cbiAgICovXG4gIHJlcGxhY2UoXG4gICAgc2VhcmNoVmFsdWU6IHtcbiAgICAgIFtTeW1ib2wucmVwbGFjZV0oc3RyaW5nOiBzdHJpbmcsIHJlcGxhY2VyOiAoc3Vic3RyaW5nOiBzdHJpbmcsIC4uLmFyZ3M6IGFueVtdKSA9PiBzdHJpbmcpOiBzdHJpbmc7XG4gICAgfSxcbiAgICByZXBsYWNlcjogKHN1YnN0cmluZzogc3RyaW5nLCAuLi5hcmdzOiBhbnlbXSkgPT4gc3RyaW5nXG4gICk6IHN0cmluZztcblxuICAvKipcbiAgICogRmluZHMgdGhlIGZpcnN0IHN1YnN0cmluZyBtYXRjaCBpbiBhIHJlZ3VsYXIgZXhwcmVzc2lvbiBzZWFyY2guXG4gICAqIEBwYXJhbSBzZWFyY2hlciBBbiBvYmplY3Qgd2hpY2ggc3VwcG9ydHMgc2VhcmNoaW5nIHdpdGhpbiBhIHN0cmluZy5cbiAgICovXG4gIHNlYXJjaChzZWFyY2hlcjogeyBbU3ltYm9sLnNlYXJjaF0oc3RyaW5nOiBzdHJpbmcpOiBudW1iZXIgfSk6IG51bWJlcjtcblxuICAvKipcbiAgICogU3BsaXQgYSBzdHJpbmcgaW50byBzdWJzdHJpbmdzIHVzaW5nIHRoZSBzcGVjaWZpZWQgc2VwYXJhdG9yIGFuZCByZXR1cm4gdGhlbSBhcyBhbiBhcnJheS5cbiAgICogQHBhcmFtIHNwbGl0dGVyIEFuIG9iamVjdCB0aGF0IGNhbiBzcGxpdCBhIHN0cmluZy5cbiAgICogQHBhcmFtIGxpbWl0IEEgdmFsdWUgdXNlZCB0byBsaW1pdCB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIHJldHVybmVkIGluIHRoZSBhcnJheS5cbiAgICovXG4gIHNwbGl0KHNwbGl0dGVyOiB7IFtTeW1ib2wuc3BsaXRdKHN0cmluZzogc3RyaW5nLCBsaW1pdD86IG51bWJlcik6IHN0cmluZ1tdIH0sIGxpbWl0PzogbnVtYmVyKTogc3RyaW5nW107XG5cbiAgLyoqXG4gICAqIFBhcnNlIHVybCBpbnRvIHBhcnQgb2JqZWN0XG4gICAqL1xuICBwYXJzZV91cmwoKToge1xuICAgIHByb3RvY29sOiBzdHJpbmc7XG4gICAgaG9zdDogc3RyaW5nO1xuICAgIGhvc3RuYW1lOiBzdHJpbmc7XG4gICAgcG9ydDogc3RyaW5nO1xuICAgIHBhdGhuYW1lOiBzdHJpbmc7XG4gICAgc2VhcmNoOiBzdHJpbmc7XG4gICAgc2VhcmNoT2JqZWN0OiBSZWNvcmQ8YW55LCBhbnk+O1xuICAgIGhhc2g6IHN0cmluZztcbiAgICBwcm90b2hvc3Q6IHN0cmluZztcbiAgfTtcblxuICAvKipcbiAgICogQ2FsbCBjc3MgZnJvbSB1cmwvcGF0aFxuICAgKi9cbiAgQ1NTKCk6IHZvaWQ7XG5cbiAgLyoqXG4gICAqIEhleCBlbmNyeXB0XG4gICAqL1xuICBoZXhFKCk6IHN0cmluZztcblxuICAvKipcbiAgICogSGV4IERlY3J5cHRcbiAgICovXG4gIGhleEQoKTogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBDYXBpdGFsaXplIGFsbCBmaXJzdCBjaGFyYWN0ZXIgc3RyaW5nXG4gICAqIEBleGFtcGxlIFtQSFBdIHVjd29yZHMoJHN0cmluZylcbiAgICovXG4gIGNhcGl0YWxpemUoKTogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBQSFAgc3RyX3JvdDEzIGVxdWl2YWxlbnRcbiAgICovXG4gIHJvdDEzKCk6IHN0cmluZztcblxuICAvKipcbiAgICogQ2hlY2sgaWYgc3RyaW5nIGVtcHR5IG9yIGJsYW5rXG4gICAqL1xuICBpc0VtcHR5KCk6IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFJlcGxhY2Ugc3RyaW5nIGJ5IGFycmF5IHBhdHRlcm5cbiAgICogQHBhcmFtIGFycmF5XG4gICAqIEBwYXJhbSByZXBsYWNlbWVudFxuICAgKi9cbiAgcmVwbGFjZUFycihhcnJheTogc3RyaW5nW10sIHJlcGxhY2VtZW50OiBzdHJpbmcpOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgYSBzdHJpbmcgdG8gSFRNTCBlbnRpdGllc1xuICAgKiBAc2VlIHtAbGluayBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMjcwMjAzMDB9XG4gICAqIEBleGFtcGxlXG4gICAqIFwiVGVzdMK04oCgwq7CpcKowqnLmeKIq8O44oCmy4bGkuKIhsO34oiR4oSixpLiiIbDpsO4z4DCo8KoIMaS4oSiZW4gdMOpc3RcIi50b0h0bWxFbnRpdGllcygpO1xuICAgKiBjb25zb2xlLmxvZyhcIkVudGl0aWVzOlwiLCBzdHIpO1xuICAgKi9cbiAgdG9IdG1sRW50aXRpZXMoKTogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBzdHJpbmcgY29udGFpbnMgc29tZSB0ZXh0IGZyb20gYXJyYXkgb2Ygc3Vic3RyaW5nc1xuICAgKiBAc2VlIHtAbGluayBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvNTU4MjYyMX1cbiAgICogQHBhcmFtIGFycmF5U3RyXG4gICAqL1xuICBpbmNsdWRlc0FycmF5KGFycmF5U3RyOiBzdHJpbmdbXSk6IGJvb2xlYW47XG59XG5cbmludGVyZmFjZSBTdHJpbmdDb25zdHJ1Y3RvciB7XG4gIC8qKlxuICAgKiBDcmVhdGUgc3RyaW5nIGZyb20gSFRNTCBlbnRpdGllc1xuICAgKiBAc2VlIHtAbGluayBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMjcwMjAzMDB9XG4gICAqIEBleGFtcGxlXG4gICAqIHZhciBzdHIgPSBcIlRlc3TCtOKAoMKuwqXCqMKpy5niiKvDuOKApsuGxpLiiIbDt+KIkeKEosaS4oiGw6bDuM+AwqPCqCDGkuKEomVuIHTDqXN0XCIudG9IdG1sRW50aXRpZXMoKTtcbiAgICogY29uc29sZS5sb2coXCJTdHJpbmc6XCIsIFN0cmluZy5mcm9tSHRtbEVudGl0aWVzKHN0cikpO1xuICAgKi9cbiAgZnJvbUh0bWxFbnRpdGllcyhzdHI6IHN0cmluZyk6IHN0cmluZztcbn1cblxuU3RyaW5nLnByb3RvdHlwZS5wcmludGYgPSBmdW5jdGlvbiAob2JqKSB7XG4gIC8qY29uc3QgaXNOb2RlID0gbmV3IEZ1bmN0aW9uKFxuICAgIFwidHJ5IHtyZXR1cm4gdGhpcz09PWdsb2JhbDt9Y2F0Y2goZSl7cmV0dXJuIGZhbHNlO31cIlxuICApO1xuXG4gIGlmIChpc05vZGUoKSkge1xuICAgIGNvbnN0IHV0aWwgPSByZXF1aXJlKFwidXRpbFwiKTtcbiAgICByZXR1cm4gdXRpbC5mb3JtYXQodGhpcywgb2JqKTtcbiAgfSovXG5cbiAgbGV0IHVzZUFyZ3VtZW50cyA9IGZhbHNlO1xuICBjb25zdCBfYXJndW1lbnRzID0gYXJndW1lbnRzO1xuICBsZXQgaSA9IC0xO1xuICBpZiAodHlwZW9mIF9hcmd1bWVudHNbMF0gPT0gJ3N0cmluZycpIHtcbiAgICB1c2VBcmd1bWVudHMgPSB0cnVlO1xuICB9XG4gIGlmIChvYmogaW5zdGFuY2VvZiBBcnJheSB8fCB1c2VBcmd1bWVudHMpIHtcbiAgICByZXR1cm4gdGhpcy5yZXBsYWNlKC8lcy9nLCBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgaSsrO1xuICAgICAgaWYgKHVzZUFyZ3VtZW50cykge1xuICAgICAgICBpZiAodHlwZW9mIF9hcmd1bWVudHNbaV0gPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICByZXR1cm4gX2FyZ3VtZW50c1tpXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0FyZ3VtZW50cyBlbGVtZW50IGlzIGFuIGludmFsaWQgdHlwZScpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gb2JqW2ldO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB0aGlzLnJlcGxhY2UoL3soW157fV0qKX0vZywgZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgIGNvbnN0IHIgPSBvYmpbYl07XG4gICAgICByZXR1cm4gdHlwZW9mIHIgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiByID09PSAnbnVtYmVyJyA/IHIgOiBhO1xuICAgIH0pO1xuICB9XG59O1xuXG5TdHJpbmcucHJvdG90eXBlLnBhcnNlX3VybCA9IGZ1bmN0aW9uICgpIHtcbiAgbGV0IHBhcnNlcjogVVJMIHwgSFRNTEFuY2hvckVsZW1lbnQ7XG4gIGlmICh0eXBlb2YgbW9kdWxlICE9ICd1bmRlZmluZWQnICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgcGFyc2VyID0gbmV3IFVSTCh0aGlzKTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgZG9jdW1lbnQgIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBwYXJzZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gIH1cbiAgY29uc3Qgc2VhcmNoT2JqZWN0OiBBcnJheTxSZWNvcmQ8YW55LCBhbnk+IHwgYW55PiA9IFtdO1xuICBsZXQgc3BsaXQ6IEFycmF5PFJlY29yZDxhbnksIGFueT4gfCBhbnk+ID0gW107XG4gIGxldCBxdWVyaWVzOiBzdHJpbmdbXSA9IFtdO1xuICAvLyBMZXQgdGhlIGJyb3dzZXIgZG8gdGhlIHdvcmtcbiAgcGFyc2VyLmhyZWYgPSB0aGlzLnRvU3RyaW5nKCk7XG4gIC8vIENvbnZlcnQgcXVlcnkgc3RyaW5nIHRvIG9iamVjdFxuICBxdWVyaWVzID0gcGFyc2VyLnNlYXJjaC5yZXBsYWNlKC9eXFw/LywgJycpLnNwbGl0KCcmJyk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgcXVlcmllcy5sZW5ndGg7IGkrKykge1xuICAgIHNwbGl0ID0gcXVlcmllc1tpXS5zcGxpdCgnPScpO1xuICAgIGlmIChzcGxpdC5sZW5ndGgpIHNlYXJjaE9iamVjdFtzcGxpdFswXV0gPSBzcGxpdFsxXTtcbiAgfVxuICByZXR1cm4ge1xuICAgIHByb3RvY29sOiBwYXJzZXIucHJvdG9jb2wsXG4gICAgaG9zdDogcGFyc2VyLmhvc3QsXG4gICAgaG9zdG5hbWU6IHBhcnNlci5ob3N0bmFtZSxcbiAgICBwb3J0OiBwYXJzZXIucG9ydCxcbiAgICBwYXRobmFtZTogcGFyc2VyLnBhdGhuYW1lLFxuICAgIHNlYXJjaDogcGFyc2VyLnNlYXJjaCxcbiAgICBzZWFyY2hPYmplY3Q6IHNlYXJjaE9iamVjdCxcbiAgICBoYXNoOiBwYXJzZXIuaGFzaCxcbiAgICBwcm90b2hvc3Q6IHBhcnNlci5wcm90b2NvbCArICcvLycgKyBwYXJzZXIuaG9zdCxcbiAgfTtcbn07XG5cbi8qKlxuICogTG9hZCBjc3NcbiAqL1xuU3RyaW5nLnByb3RvdHlwZS5DU1MgPSBmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaW5rJyk7XG4gIGUucmVsID0gJ3N0eWxlc2hlZXQnO1xuXG4gIGUuaHJlZiA9IHRoaXMudG9TdHJpbmcoKTtcbiAgY29uc3QgbiA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF07XG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyXG4gICAgPyB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgJ2xvYWQnLFxuICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgbi5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlLCBuKTtcbiAgICAgICAgfSxcbiAgICAgICAgITFcbiAgICAgIClcbiAgICA6IHdpbmRvdy5hdHRhY2hFdmVudFxuICAgID8gd2luZG93LmF0dGFjaEV2ZW50KCdvbmxvYWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIG4ucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZSwgbik7XG4gICAgICB9KVxuICAgIDogKHdpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIG4ucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZSwgbik7XG4gICAgICB9KTtcbn07XG5cblN0cmluZy5wcm90b3R5cGUudHJpbSA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRoaXMucmVwbGFjZSgvXlxccyt8XFxzKyQvZ20sICcnKTtcbn07XG5cblN0cmluZy5wcm90b3R5cGUuaGV4RSA9IGZ1bmN0aW9uICgpIHtcbiAgbGV0IGhleDogc3RyaW5nLCBpOiBudW1iZXI7XG5cbiAgbGV0IHJlc3VsdCA9ICcnO1xuICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xuICAgIGhleCA9IHRoaXMuY2hhckNvZGVBdChpKS50b1N0cmluZygxNik7XG4gICAgcmVzdWx0ICs9ICgnMDAwJyArIGhleCkuc2xpY2UoLTQpO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cblN0cmluZy5wcm90b3R5cGUuaGV4RCA9IGZ1bmN0aW9uICgpIHtcbiAgbGV0IGo6IG51bWJlcjtcbiAgY29uc3QgaGV4ZXMgPSB0aGlzLm1hdGNoKC8uezEsNH0vZykgfHwgW107XG4gIGxldCBiYWNrID0gJyc7XG4gIGZvciAoaiA9IDA7IGogPCBoZXhlcy5sZW5ndGg7IGorKykge1xuICAgIGJhY2sgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShwYXJzZUludChoZXhlc1tqXSwgMTYpKTtcbiAgfVxuXG4gIHJldHVybiBiYWNrO1xufTtcblxuU3RyaW5nLnByb3RvdHlwZS5jYXBpdGFsaXplID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHRoaXMuc2xpY2UoMSk7XG59O1xuXG5TdHJpbmcucHJvdG90eXBlLnJvdDEzID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5yZXBsYWNlKC9bYS16QS1aXS9nLCBmdW5jdGlvbiAoYzogYW55KSB7XG4gICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgPD0gJ1onID8gOTAgOiAxMjIpID49IChjID0gYy5jaGFyQ29kZUF0KDApICsgMTMpID8gYyA6IGMgLSAyNik7XG4gIH0pO1xufTtcblxuU3RyaW5nLnByb3RvdHlwZS50cnVuY2F0ZSA9IGZ1bmN0aW9uIChuOiBudW1iZXIsIHVzZVdvcmRCb3VuZGFyeTogYm9vbGVhbiB8IG51bGwpIHtcbiAgaWYgKHRoaXMubGVuZ3RoIDw9IG4pIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBjb25zdCBzdWJTdHJpbmcgPSB0aGlzLnN1YnN0cigwLCBuIC0gMSk7IC8vIHRoZSBvcmlnaW5hbCBjaGVja1xuICByZXR1cm4gKHVzZVdvcmRCb3VuZGFyeSA/IHN1YlN0cmluZy5zdWJzdHIoMCwgc3ViU3RyaW5nLmxhc3RJbmRleE9mKCcgJykpIDogc3ViU3RyaW5nKSArICcmaGVsbGlwOyc7XG59O1xuXG5TdHJpbmcucHJvdG90eXBlLmlzRW1wdHkgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICh0aGlzICE9IG51bGwgfHwgdHlwZW9mIHRoaXMgIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gdGhpcy5sZW5ndGggPT09IDAgfHwgIXRoaXMudHJpbSgpO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn07XG5cblN0cmluZy5wcm90b3R5cGUucmVwbGFjZUFyciA9IGZ1bmN0aW9uICh0aGlzOiBzdHJpbmcsIGFycmF5OiBzdHJpbmdbXSwgcmVwbGFjZW1lbnQ6IHN0cmluZykge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXRoaXMtYWxpYXNcbiAgbGV0IG9yaSA9IHRoaXM7XG4gIGFycmF5Lm1hcCgoc3RyKSA9PiB7XG4gICAgb3JpID0gb3JpLnJlcGxhY2Uoc3RyLCByZXBsYWNlbWVudCk7XG4gIH0pO1xuICByZXR1cm4gb3JpO1xufTtcblxuU3RyaW5nLnByb3RvdHlwZS50b0h0bWxFbnRpdGllcyA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRoaXMucmVwbGFjZSgvLi9nbSwgZnVuY3Rpb24gKHMpIHtcbiAgICAvLyByZXR1cm4gXCImI1wiICsgcy5jaGFyQ29kZUF0KDApICsgXCI7XCI7XG4gICAgcmV0dXJuIHMubWF0Y2goL1thLXowLTlcXHNdKy9pKSA/IHMgOiAnJiMnICsgcy5jaGFyQ29kZUF0KDApICsgJzsnO1xuICB9KTtcbn07XG5cblN0cmluZy5mcm9tSHRtbEVudGl0aWVzID0gZnVuY3Rpb24gKHN0cikge1xuICByZXR1cm4gKHN0ciArICcnKS5yZXBsYWNlKC8mI1xcZCs7L2dtLCBmdW5jdGlvbiAocykge1xuICAgIGNvbnN0IG0gPSBzLm1hdGNoKC9cXGQrL2dtKVswXTtcbiAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZSg8YW55Pm0pO1xuICB9KTtcbn07XG5cblN0cmluZy5wcm90b3R5cGUuaW5jbHVkZXNBcnJheSA9IGZ1bmN0aW9uIChzdWJzdHJpbmdzKSB7XG4gIHJldHVybiBzdWJzdHJpbmdzLnNvbWUoKHYpID0+IHRoaXMuaW5jbHVkZXModikpO1xufTtcblxuY29uc3QgX19fZ2xvYmFsID0gKHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiBnbG9iYWwpIC8qIG5vZGUgKi8gYXMgYW55O1xuXG4vKipcbiAqIGVhc3kgcmVnZXggbWF0Y2hcbiAqIEBwYXJhbSBzdHJcbiAqIEBwYXJhbSBwYXR0ZXJuXG4gKiBAcmV0dXJuc1xuICovXG5mdW5jdGlvbiBzdHJNYXRjaChzdHI6IHN0cmluZywgcGF0dGVybjogUmVnRXhwIHwgc3RyaW5nKSB7XG4gIGxldCByZWdleDogUmVnRXhwO1xuICBpZiAodHlwZW9mIHBhdHRlcm4gPT0gJ3N0cmluZycpIHtcbiAgICByZWdleCA9IG5ldyBSZWdFeHAocGF0dGVybiwgJ2dtJyk7XG4gIH0gZWxzZSB7XG4gICAgcmVnZXggPSBwYXR0ZXJuO1xuICB9XG4gIGNvbnN0IG1hdGNoID0gc3RyLm1hdGNoKHJlZ2V4KSB8fCBmYWxzZTtcbiAgaWYgKEFycmF5LmlzQXJyYXkobWF0Y2gpKSB7XG4gICAgaWYgKG1hdGNoLmxlbmd0aCA+IDApIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cbl9fX2dsb2JhbC5zdHJNYXRjaCA9IHN0ck1hdGNoO1xuXG5TdHJpbmcucHJvdG90eXBlLmlzTWF0Y2ggPSBmdW5jdGlvbiAodGhpczogc3RyaW5nLCBwYXR0ZXJuKSB7XG4gIHJldHVybiBzdHJNYXRjaCh0aGlzLCBwYXR0ZXJuKTtcbn07XG5cbmlmICh0eXBlb2YgJycucmVwbGFjZUFsbCAhPSAnZnVuY3Rpb24nKSB7XG4gIFN0cmluZy5wcm90b3R5cGUucmVwbGFjZUFsbCA9IGZ1bmN0aW9uIChzZWFyY2gsIHJlcGxhY2VtZW50KSB7XG4gICAgY29uc3QgZmluZCA9IHR5cGVvZiBzZWFyY2ggPT0gJ3N0cmluZycgPyBuZXcgUmVnRXhwKHNlYXJjaCwgJ2dtJykgOiBzZWFyY2g7XG4gICAgcmV0dXJuIHRoaXMucmVwbGFjZShmaW5kLCByZXBsYWNlbWVudCk7XG4gIH07XG59XG4iXX0=